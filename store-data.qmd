---
title: "Storing Data"
---

The default database for storing survey responses is [Supabase]({{< var url_supabase >}}). We plan to also support the ability to use your own database in the future.

Below are the steps you need to go through on [Supabase]({{< var url_supabase >}}):

1.  Create a Supabase account
2.  Create a Supabase project
3.  Copy your credentials

We'll walk you through one by one.

## 1. Create a Supabase account

Navigate to the [Supabase]({{< var url_supabase >}}) website and create an account. You may use your GitHub account or create a new account using your email.

While creating your account, it's by default that you will have an organization under your account name. Your projects will be designated to this organization. You can have other organizations based on your need, but let's just use this default one for now.

## 2. Create a Supabase project

Once you are logged in, the page will prompt you to create a project. It's an obvious green button. Click on it and select your organization. A dialog box will pop up like this:

<center>
<img src="images/screenshots/database_01.jpg" style="max-width: 600px; width: 100%;">
</center>
<br>

Fill in the project name and give it a strong password. Choose a region that is close to you (or close to your audiences). All settings can be modified at any time.

::: {.callout-tip}

To avoid confusion, you need to deal with password both on Supabase and surveydown:

1.  Supabase is where your password is **defined**. Set your password in this dialog box, or change it in project settings anytime.

2.  On surveydown, you deliver this password using `sd_set_password()`.

:::

::: {.callout-important}

Your database password will be used in your surveydown survey(s) as credential to communicate with Supabase, and will also be your surveydown survey admin page password. Please choose a strong password and secure it.

To know more about setting the password for your surveydown survey, go to the [Password](password.qmd) page.

:::

It takes several minutes to set up the database. You will know when it's ready.

## 3: Copy your credentials

Once your Supabase project is ready, go to **"Project Settings"** located at the bottom-left corner. Then, click on **"Database"** under "Configuration".

You'll see the **"Connection parameters"** section like this:

<center>
<img src="images/screenshots/database_02.jpg" style="max-width: 800px; width: 100%;">
</center>
<br>

::: {.callout-tip}

This is also where you change the password of your Supabase project.

:::

Now, deliver these parameters to your survey! In your survey `.qmd` file, you define `sd_database()` in your setup chunk. In the template it looks like this:

```{r}
# In your setup chunk
db <- sd_database(
  host   = NULL,
  dbname = NULL,
  port   = NULL,
  user   = NULL,
  table  = NULL
)
```

Copy and paste the first 4 parameters from your Supabase page to `sd_database()`, aka "Host", "Database name", "Port", and "User". Again, your password should be defined using `sd_set_password()` in your R console, NOT in the `.qmd` file.

The last parameter, `table`, can be anything of your choice. After your survey gets running, a table with this name will appear in **"Table Editor"** of your Supabase project. It's located at the top-left corner of the page.

::: {.callout-tip}
**Run without Supabase:**

If you don't have a database setup yet, you can just leave the function blank and your survey will still run. Your survey data will be stored locally.

```{r}
db <- sd_database()
```

:::

::: {.callout-tip}
**Ignore Supabase connection:**

At anytime, you can ignore Supabase connection by defining `ignore = TRUE` under `sd_database()`. Your survey data will be stored locally.

```{r}
db <- sd_database(
    # Previous parameters...
    ignore = TRUE
)
```

:::

::: {.callout-tip}
**Disable `gssencmode`:**

If you've set everything correctly but still encounter connection error, try to disable `gssencmode`:

```{r}
db <- sd_database(
    # Previous parameters...
    gssencmode = "disable"
)
```

By default, `gssencmode` is set as `"prefer"`. It secures your connection with PostgreSQL, which is the SQL used by Supabase. We generally recommend that you **DON'T disable `gssencmode`**.

:::

Now you have completed your database settings. Once your survey is up and running, you can monitor the survey responses in **"Table Editor"** of your Supabase project. Again it's located at the top-left corner of the page. The responses will update in real time, or you can refresh it manually.

